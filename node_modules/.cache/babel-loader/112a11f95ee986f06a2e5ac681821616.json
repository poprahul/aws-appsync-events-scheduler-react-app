{"ast":null,"code":"var __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nvar RecordingCache = function () {\n  function RecordingCache(data) {\n    if (data === void 0) {\n      data = {};\n    }\n\n    this.data = data;\n    this.recordedData = {};\n  }\n\n  RecordingCache.prototype.record = function (transaction) {\n    transaction(this);\n    var recordedData = this.recordedData;\n    this.recordedData = {};\n    return recordedData;\n  };\n\n  RecordingCache.prototype.toObject = function () {\n    return __assign({}, this.data, this.recordedData);\n  };\n\n  RecordingCache.prototype.get = function (dataId) {\n    if (this.recordedData.hasOwnProperty(dataId)) {\n      return this.recordedData[dataId];\n    }\n\n    return this.data[dataId];\n  };\n\n  RecordingCache.prototype.set = function (dataId, value) {\n    if (this.get(dataId) !== value) {\n      this.recordedData[dataId] = value;\n    }\n  };\n\n  RecordingCache.prototype.delete = function (dataId) {\n    this.recordedData[dataId] = undefined;\n  };\n\n  RecordingCache.prototype.clear = function () {\n    var _this = this;\n\n    Object.keys(this.data).forEach(function (dataId) {\n      return _this.delete(dataId);\n    });\n    this.recordedData = {};\n  };\n\n  RecordingCache.prototype.replace = function (newData) {\n    this.clear();\n    this.recordedData = __assign({}, newData);\n  };\n\n  return RecordingCache;\n}();\n\nexport { RecordingCache };\nexport function record(startingState, transaction) {\n  var recordingCache = new RecordingCache(startingState);\n  return recordingCache.record(transaction);\n}","map":{"version":3,"sources":["../src/recordingCache.ts"],"names":[],"mappings":";;;;;;;;;;;;;;AAEA,IAAA,cAAA,GAAA,YAAA;AAGE,WAAA,cAAA,CAA6B,IAA7B,EAA6D;AAAhC,QAAA,IAAA,KAAA,KAAA,CAAA,EAAA;AAAA,MAAA,IAAA,GAAA,EAAA;AAAgC;;AAAhC,SAAA,IAAA,GAAA,IAAA;AAFrB,SAAA,YAAA,GAAsC,EAAtC;AAEyD;;AAE1D,EAAA,cAAA,CAAA,SAAA,CAAA,MAAA,GAAP,UACE,WADF,EACuD;AAErD,IAAA,WAAW,CAAC,IAAD,CAAX;AACA,QAAM,YAAY,GAAG,KAAK,YAA1B;AACA,SAAK,YAAL,GAAoB,EAApB;AACA,WAAO,YAAP;AACD,GAPM;;AASA,EAAA,cAAA,CAAA,SAAA,CAAA,QAAA,GAAP,YAAA;AACE,WAAA,QAAA,CAAA,EAAA,EAAY,KAAK,IAAjB,EAA0B,KAAK,YAA/B,CAAA;AACD,GAFM;;AAIA,EAAA,cAAA,CAAA,SAAA,CAAA,GAAA,GAAP,UAAW,MAAX,EAAyB;AACvB,QAAI,KAAK,YAAL,CAAkB,cAAlB,CAAiC,MAAjC,CAAJ,EAA8C;AAE5C,aAAO,KAAK,YAAL,CAAkB,MAAlB,CAAP;AACD;;AACD,WAAO,KAAK,IAAL,CAAU,MAAV,CAAP;AACD,GANM;;AAQA,EAAA,cAAA,CAAA,SAAA,CAAA,GAAA,GAAP,UAAW,MAAX,EAA2B,KAA3B,EAA6C;AAC3C,QAAI,KAAK,GAAL,CAAS,MAAT,MAAqB,KAAzB,EAAgC;AAC9B,WAAK,YAAL,CAAkB,MAAlB,IAA4B,KAA5B;AACD;AACF,GAJM;;AAMA,EAAA,cAAA,CAAA,SAAA,CAAA,MAAA,GAAP,UAAc,MAAd,EAA4B;AAC1B,SAAK,YAAL,CAAkB,MAAlB,IAA4B,SAA5B;AACD,GAFM;;AAIA,EAAA,cAAA,CAAA,SAAA,CAAA,KAAA,GAAP,YAAA;AAAA,QAAA,KAAA,GAAA,IAAA;;AACE,IAAA,MAAM,CAAC,IAAP,CAAY,KAAK,IAAjB,EAAuB,OAAvB,CAA+B,UAAA,MAAA,EAAM;AAAI,aAAA,KAAI,CAAC,MAAL,CAAA,MAAA,CAAA;AAAmB,KAA5D;AACA,SAAK,YAAL,GAAoB,EAApB;AACD,GAHM;;AAKA,EAAA,cAAA,CAAA,SAAA,CAAA,OAAA,GAAP,UAAe,OAAf,EAA6C;AAC3C,SAAK,KAAL;AACA,SAAK,YAAL,GAAiB,QAAA,CAAA,EAAA,EAAQ,OAAR,CAAjB;AACD,GAHM;;AAIT,SAAA,cAAA;AAAC,CA7CD,EAAA;;;AA+CA,OAAM,SAAU,MAAV,CACJ,aADI,EAEJ,WAFI,EAEiD;AAErD,MAAM,cAAc,GAAG,IAAI,cAAJ,CAAmB,aAAnB,CAAvB;AACA,SAAO,cAAc,CAAC,MAAf,CAAsB,WAAtB,CAAP;AACD","sourceRoot":"","sourcesContent":["var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar RecordingCache = (function () {\n    function RecordingCache(data) {\n        if (data === void 0) { data = {}; }\n        this.data = data;\n        this.recordedData = {};\n    }\n    RecordingCache.prototype.record = function (transaction) {\n        transaction(this);\n        var recordedData = this.recordedData;\n        this.recordedData = {};\n        return recordedData;\n    };\n    RecordingCache.prototype.toObject = function () {\n        return __assign({}, this.data, this.recordedData);\n    };\n    RecordingCache.prototype.get = function (dataId) {\n        if (this.recordedData.hasOwnProperty(dataId)) {\n            return this.recordedData[dataId];\n        }\n        return this.data[dataId];\n    };\n    RecordingCache.prototype.set = function (dataId, value) {\n        if (this.get(dataId) !== value) {\n            this.recordedData[dataId] = value;\n        }\n    };\n    RecordingCache.prototype.delete = function (dataId) {\n        this.recordedData[dataId] = undefined;\n    };\n    RecordingCache.prototype.clear = function () {\n        var _this = this;\n        Object.keys(this.data).forEach(function (dataId) { return _this.delete(dataId); });\n        this.recordedData = {};\n    };\n    RecordingCache.prototype.replace = function (newData) {\n        this.clear();\n        this.recordedData = __assign({}, newData);\n    };\n    return RecordingCache;\n}());\nexport { RecordingCache };\nexport function record(startingState, transaction) {\n    var recordingCache = new RecordingCache(startingState);\n    return recordingCache.record(transaction);\n}\n//# sourceMappingURL=recordingCache.js.map"]},"metadata":{},"sourceType":"module"}